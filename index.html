<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>US States Map</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/topojson-client@3"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }
        h1 {
            color: #4CAF50;
            text-align: center;
        }
        #map-container {
            width: 100%;
            height: 600px;
            margin: 0 auto;
        }
        .state {
            fill: #ccc;
            stroke: #fff;
            stroke-width: 0.5px;
            transition: fill 0.3s;
        }
        .state:hover {
            fill: #999;
            cursor: pointer;
        }
        .state.active {
            fill: #4CAF50;
        }
    </style>
</head>
<body>
    <h1>Interactive US States Map</h1>
    <div id="map-container"></div>

    <script>
        // Wait for the page to load
        document.addEventListener('DOMContentLoaded', function() {
            // Create the SVG element
            const width = 960;
            const height = 600;
            const svg = d3.select("#map-container")
                .append("svg")
                .attr("width", width)
                .attr("height", height)
                .attr("viewBox", [0, 0, width, height])
                .style("max-width", "100%")
                .style("height", "auto");
            
            // Add a group element for the map
            const g = svg.append("g");
            
            // Define projection and path generator
            const projection = d3.geoAlbersUsa()
                .translate([width / 2, height / 2])
                .scale(1000);
            
            const path = d3.geoPath()
                .projection(projection);
            
            // Load the TopoJSON data
            d3.json("us-states-10m.json")
                .then(function(us) {
                    console.log("Data loaded successfully:", us);
                    
                    // Extract the states features
                    const states = topojson.feature(us, us.objects.states).features;
                    
                    // Draw the states
                    g.selectAll("path")
                        .data(states)
                        .enter()
                        .append("path")
                        .attr("class", "state")
                        .attr("d", path)
                        .on("click", function(event, d) {
                            // Remove active class from all states
                            d3.selectAll(".state").classed("active", false);
                            
                            // Add active class to clicked state
                            d3.select(this).classed("active", true);
                            
                            // Get state name
                            const stateName = d.properties.name || "Unknown State";
                            alert("Clicked on: " + stateName);
                        });
                    
                    // Add state borders
                    g.append("path")
                        .datum(topojson.mesh(us, us.objects.states, (a, b) => a !== b))
                        .attr("fill", "none")
                        .attr("stroke", "#fff")
                        .attr("stroke-width", "0.5")
                        .attr("d", path);
                })
                .catch(function(error) {
                    console.error("Error loading the map data:", error);
                    document.getElementById("map-container").innerHTML = 
                        "<p>Error loading map data. Please check console for details.</p>";
                });
        });
    </script>
</body>
</html>